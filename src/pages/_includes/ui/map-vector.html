{% assign id = include.map-id %}
{% assign data = site.data.maps-vector[id] %}
{% assign color = include.color | default: data.color | default: 'green' %}

{% if data %}
	<div class="ratio ratio-16x9">
		<div>
			<div id="map-{{ id }}" class="w-100 h-100"></div>
		</div>
	</div>

	{% capture script %}
	<script>
		// @formatter:on
		{% if jekyll.environment == 'development' %}window.tabler_map_vector = window.tabler_map_vector || {};{% endif %}

		document.addEventListener("DOMContentLoaded", function() {
			{% if jekyll.environment == 'development' %}window.tabler_map_vector["map-{{ id }}"] = {% endif %}new jsVectorMap({
				selector: '#map-{{ id }}',
				map: '{{ data.map }}',
				backgroundColor: 'transparent',
				regionStyle: {
					initial: {
						fill: "rgba(120, 130, 140, .1)",
						stroke: "transparent"
					}
				},
				// labels: {
				// 	regions: {
				// 		render(code) {
				// 			return ['EG', 'US', 'CH'].indexOf(code) > -1 ? code : null
				// 		}
				// 	}
				// },
				zoomOnScroll: {% if data.zoom %}true{% else %}false{% endif %},
				zoomButtons: {% if data.zoom %}true{% else %}false{% endif %},
				{% if data.values %}
				// -------- Series --------
				series: {
					regions: [{
						legend: {
							title: '{{ data.label }}',
						},
						attribute: 'fill',
						scale: {
							one: '#5c5cff',
							two: '#ff9251',
							three: '#56de80',
						},
						values: {{ data.values }},
					}]
				},
				{% endif %}
			});
		});
		// @formatter:off
	</script>
	{% endcapture %}

	{% if include.show-scripts %}
		{{ script }}
	{% else %}
		{% capture_global scripts %}
			{{ script }}
		{% endcapture_global %}
	{% endif %}
{% endif %}
